# Context
Filename: task.md
Created On: 2025-11-20
Created By: AI
Associated Protocol: RIPER-5 + Multidimensional + Agent Protocol

# Task Description
Refactor "Dense Forest" (Stage 0) to match the "Fairyland" (Stage 4) 2.5D construction style.
- **Goal**: Convert Stage 0 from a tiled 2D background to a 2.5D floating island style with a forest theme.
- **Features**:
    -   Circular Map (R=600).
    -   Procedural Decorations (Forest Trees, Bushes).
    -   2.5D Tilted Perspective.
    -   Atmospheric Weather (Spores/Fireflies).

# Project Overview
Lingjian Game.

---
*The following sections are maintained by the AI during protocol execution*
---

# Analysis (Populated by RESEARCH mode)
- **Current State**: Stage 0 is tiled 2D.
- **Target State**: Stage 0 is 2.5D Island.
- **Assets**: Need `tree_forest` and `bush`.
- **Engine**: Need to generalize Stage 4's rendering logic to support Stage 0 configurations.

# Proposed Solution (Populated by INNOVATE mode)
-   **Assets**: Add `tree_forest` (dark broadleaf), `bush` (small green clumps).
-   **Weather**: Add `spores` effect (floating green particles).
-   **Engine**:
    -   `initForest()`: Scatter trees/bushes. Denser at edges.
    -   `draw()`: Use the 2.5D pipeline for Stage 0, configuring colors for a dark forest theme.
    -   `spawnEnemy`: Constrain to R=600 for Stage 0 as well.

# Implementation Plan (Generated by PLAN mode)
Implementation Checklist:
1.  [ ] Modify `js/data.js`: Add `tree_forest`, `bush` SVGs.
2.  [ ] Modify `js/weather.js`: Add `spores` weather type.
3.  [ ] Modify `js/engine.js`:
    -   Update `spawnEnemy` (Stage 0 & 4).
    -   Implement `initForest`.
    -   Refactor `draw` to handle Stage 0 using the 2.5D perspective.
